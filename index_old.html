<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Help Docs ~ Scout APM</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/screen_overrides.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

    <link href='https://fonts.googleapis.com/css?family=Exo:400,400italic,700,700italic,800,800italic|Signika:400,700,300' rel='stylesheet' type='text/css'> 

  </head>

  <body class="index_old">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img id="logo" src="images/logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='#'>Sign Up for a Developer Key</a></li>
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 class="dark">Scout Help Docs</h1>

<p>Welcome to the Kittn API! You can use our API to access Kittn API endpoints, which can get information on various cats, kittens, and breeds in our database.</p>

<p>We have language bindings in Shell, Ruby, and Python! You can view code examples in the dark area to the right, and you can switch the programming language of the examples with the tabs in the top right.</p>

<p>This example API documentation page was created with <a href="http://github.com/tripit/slate">Slate</a>. Feel free to edit it and use it as a base for your own API&rsquo;s documentation.</p>

<h1 id="authentication">Authentication</h1>

<blockquote>
<p>To authorize, use this code:</p>
</blockquote>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
</code></pre>

<!-- ```python
import kittn

api = kittn.authorize('meowmeowmeow')
``` -->

<!-- ```shell
# With shell, you can just pass the correct header with each request
curl "api_endpoint_here"
  -H "Authorization: meowmeowmeow"
``` -->

<blockquote>
<p>Make sure to replace <code class="prettyprint">meowmeowmeow</code> with your API key.</p>
</blockquote>

<p>Kittn uses API keys to allow access to the API. You can register a new Kittn API key at our <a href="http://example.com/developers">developer portal</a>.</p>

<p>Kittn expects for the API key to be included in all API requests to the server in a header that looks like the following:</p>

<p><code class="prettyprint">Authorization: meowmeowmeow</code></p>

<aside class="notice">
You must replace <code>meowmeowmeow</code> with your personal API key.
</aside>

<h1 id="kittens">Kittens</h1>

<h2 id="get-all-kittens">Get All Kittens</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">get</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">()</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"http://example.com/api/kittens"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Fluffums"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"calico"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Isis"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
    </span><span class="nt">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
    </span><span class="nt">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves all kittens.</p>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/api/kittens</code></p>

<h3 id="query-parameters">Query Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>include_cats</td>
<td>false</td>
<td>If set to true, the result will also include cats.</td>
</tr>
<tr>
<td>available</td>
<td>true</td>
<td>If set to false, the result will include kittens that have already been adopted.</td>
</tr>
</tbody></table>

<aside class="success">
Remember â€” a happy kitten is an authenticated kitten!
</aside>

<h2 id="get-a-specific-kitten">Get a Specific Kitten</h2>
<pre class="highlight ruby"><code><span class="nb">require</span> <span class="s1">'kittn'</span>

<span class="n">api</span> <span class="o">=</span> <span class="no">Kittn</span><span class="o">::</span><span class="no">APIClient</span><span class="p">.</span><span class="nf">authorize!</span><span class="p">(</span><span class="s1">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="p">.</span><span class="nf">kittens</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
<pre class="highlight python"><code><span class="kn">import</span> <span class="nn">kittn</span>

<span class="n">api</span> <span class="o">=</span> <span class="n">kittn</span><span class="o">.</span><span class="n">authorize</span><span class="p">(</span><span class="s">'meowmeowmeow'</span><span class="p">)</span>
<span class="n">api</span><span class="o">.</span><span class="n">kittens</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</code></pre>
<pre class="highlight shell"><code>curl <span class="s2">"http://example.com/api/kittens/2"</span>
  -H <span class="s2">"Authorization: meowmeowmeow"</span>
</code></pre>

<blockquote>
<p>The above command returns JSON structured like this:</p>
</blockquote>
<pre class="highlight json"><code><span class="p">{</span><span class="w">
  </span><span class="nt">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
  </span><span class="nt">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Isis"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"breed"</span><span class="p">:</span><span class="w"> </span><span class="s2">"unknown"</span><span class="p">,</span><span class="w">
  </span><span class="nt">"fluffiness"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
  </span><span class="nt">"cuteness"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<p>This endpoint retrieves a specific kitten.</p>

<aside class="warning">If you&rsquo;re not using an administrator API key, note that some kittens will return 403 Forbidden if they are hidden for admins only.</aside>

<h3 id="http-request">HTTP Request</h3>

<p><code class="prettyprint">GET http://example.com/kittens/&lt;ID&gt;</code></p>

<h3 id="url-parameters">URL Parameters</h3>

<table><thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>ID</td>
<td>The ID of the kitten to retrieve</td>
</tr>
</tbody></table>

          <h1 id="configuration">Configuration</h1>

<h2 id="requirements">Requirements</h2>

<h3 id="monitoring">Monitoring</h3>

<p>Scout currently supports Ruby on Rails 2.2+ and Ruby 1.8.7+ and the following app servers:</p>

<ul>
<li>Phusion Passenger</li>
<li>Puma</li>
<li>Rainbows</li>
<li>Thin</li>
<li>Unicorn</li>
<li>WEBrick</li>
</ul>

<h3 id="stack-profiling">Stack Profiling</h3>

<p>Stack Profiling requires Ruby 2.1+.</p>

<h3 id="git-integration">Git Integration</h3>

<p>Viewing your application code within Scout requires that your source code is hosted at Github.com.</p>

<h2 id="installation">Installation</h2>

<p>Tailored instructions are provided within our user interface. General instructions:</p>

<table class="help install">
  <tbody>
        <tr>
      <td>
        <span class="step">1</span>
      </td>
      <td>
                <p>Your Gemfile:</p>

<pre>
gem 'scout_apm'
</pre>

                    <p><strong>Shell:</strong></p>

<pre>
bundle install
</pre>
      </td>
     </tr>
     <tr>
        <td><span class="step">2</span></td>
        <td><p>Download your customized config file, placing it at <code>config/scout_apm.yml</code>.</p></td>
     </tr>
          <tr>
        <td><span class="step">3</span></td>
        <td><p>Deploy.</p></td>
     </tr>
    </tbody>
 </table>

<h2 id="configuration-options">Configuration Options</h2>

<p>Scout APM can be configured via the <code class="prettyprint">config/scout_apm.yml</code> Yaml file and/or environment variables. A config file with your organization key is available for download as part of the install instructions.</p>

<h3 id="erb-evaluation">ERB evaluation</h3>

<p>ERB is evaluated when loading the config file. For example, you can set the app name based on the hostname:</p>
<pre class="highlight ruby"><code><span class="ss">common: </span><span class="o">&amp;</span><span class="n">defaults</span>
  <span class="ss">name: </span><span class="o">&lt;</span><span class="sx">%= "ProjectPlanner.io (#{Rails.env})" %&gt;
</span></code></pre>

<h3 id="configuration-reference">Configuration Reference</h3>

<p>The following configuration settings are available:</p>

<table class="lookup">
    <thead>
      <tr>
        <th>
          Setting&nbsp;Name
        </th>
        <th>
          Description
        </th>
        <th>
          Default
        </th>
        <th>
          Required
        </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>
          name
        </th>
        <td>
          Name of the application (ex: &lsquo;Photos App&rsquo;).
        </td>
        <td>
          <code>Rails.application.class.to_s.
             sub(/::Application$/, '')</code>
        </td>
        <td>
          Yes
        </td>
      </tr>
      <tr>
        <th>
          key
        </th>
        <td>
          The organization API key.
        </td>
        <td></td>
        <td>
          Yes
        </td>
      </tr>
      <tr>
        <th>
          monitor
        </th>
        <td>
          Whether monitoring should be enabled. 
        </td>
        <td>
          <code>false</code>
        </td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          log_level
        </th>
        <td>
          The logging level of the agent. 
        </td>
        <td>
          <code>INFO</code>
        </td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          log_file_path
        </th>
        <td>The path to the <code>scout_apm.log</code> log file directory. Use <code>stdout</code> to log to STDOUT.
        </td>
        <td>
          <code>Environment#root+log/</code>&nbsp;or <code>STDOUT</code> if running on Heroku.
        </td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          proxy
        </th>
        <td>Specify the proxy URL (ex: <code>https://proxy</code>) if a proxy is required. 
        </td>
        <td></td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          host
        </th>
        <td>
          The protocol + domain where the agent should report. 
        </td>
        <td>
          <code>https://apm.scoutapp.com</code>
        </td>
        <td>
          No
        </td>
      </tr>
    </tbody>
  </table>

<h3 id="environment-variables">Environment Variables</h3>

<p>You can also configure Scout APM via environment variables. Environment variables override settings provided in <code class="prettyprint">scout_apm.yml</code>.</p>

<p>Environment variables have the same names as those in the Yaml config file, but are prefixed with <code class="prettyprint">SCOUT_</code>. For example, to set the organization key via environment variables:</p>
<pre class="highlight ruby"><code><span class="n">export</span> <span class="no">SCOUT_KEY</span><span class="o">=</span><span class="no">YOURKEY</span>
</code></pre>

<h2 id="heroku">Heroku</h2>

<p>Scout runs on Heroku without any special configuration. When Scout detects that an app is being served via Heroku:</p>

<ul>
<li>Logging is set to <code class="prettyprint">STDOUT</code> vs. logging to a file. Log messages are prefixed with <code class="prettyprint">[Scout]</code> for easy filtering.</li>
<li>The dyno name (ex: <code class="prettyprint">web.1</code>) is reported vs. the dyno hostname. Dyno hostnames are dynamically generated and don&rsquo;t have any meaningful information.</li>
</ul>

<h3 id="configuration">Configuration</h3>

<p>Scout can be configured via environment variables. This means you can use <code class="prettyprint">heroku config:set</code> to configure the agent. For example, you can set the application name that appears in the Scout UI with:</p>
<pre class="highlight shell"><code>heroku config:set <span class="nv">SCOUT_NAME</span><span class="o">=</span><span class="s1">'My Heroku App'</span>
</code></pre>

<p>See the configuration section for more information on the available config settings and environment variable functionality.</p>

<h2 id="instrumented-libaries">Instrumented Libaries</h2>

<p>The following libraries are currently instrumented:</p>

<ul>
<li>ActiveRecord</li>
<li>ActionView</li>
<li>ActionController</li>
<li>Mongoid</li>
<li>Net::HTTP</li>
<li>Moped</li>
</ul>

<h2 id="adding-custom-context">Adding Custom Context</h2>

<p><a href="#context">Context</a> lets you see the forest from the trees. For example, you can add custom context to answer critical questions like:</p>

<ul>
<li>How many users are impacted by slow requests?</li>
<li>How many trial customers are impacted by slow requests?</li>
<li>How much of an impact are slow requests having on our highest paying customers?</li>
</ul>

<p>It&rsquo;s simple to add <a href="#context">custom context</a> to your app. There are two types of context:</p>

<h3 id="user-context">User Context</h3>

<p>For context used to identify users (ex: email, name):</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">({})</span>
</code></pre>

<p>Examples:</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">(</span><span class="ss">email: </span><span class="vi">@user</span><span class="p">.</span><span class="nf">email</span><span class="p">)</span>
<span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">(</span><span class="ss">email: </span><span class="vi">@user</span><span class="p">.</span><span class="nf">email</span><span class="p">,</span> <span class="ss">location: </span><span class="vi">@user</span><span class="p">.</span><span class="nf">location</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
</code></pre>

<h3 id="general-context">General Context</h3>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">({})</span>
</code></pre>

<p>Examples:</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">account: </span><span class="vi">@account</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
<span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">database_shard: </span><span class="vi">@db</span><span class="p">.</span><span class="nf">shard_id</span><span class="p">,</span> <span class="ss">monthly_spend: </span><span class="vi">@account</span><span class="p">.</span><span class="nf">monthly_spend</span><span class="p">)</span>
</code></pre>

<h3 id="default-context">Default Context</h3>

<p>Scout reports the Request URI and the user&rsquo;s remote IP Address by default.</p>

<h3 id="context-types">Context Types</h3>

<p>Context values can be any of the following types:</p>

<ul>
<li>Numeric</li>
<li>String</li>
<li>Boolean</li>
<li>Time</li>
<li>Date</li>
</ul>

<h3 id="context-field-name-restrictions">Context Field Name Restrictions</h3>

<p>Custom context names may contain alphanumeric characters, dashes, and underscores. Spaces are not allowed.</p>

<p>Attempts to add invalid context will be ignored.</p>

<h3 id="example-adding-the-current-user-39-s-email-as-context">Example: adding the current user&rsquo;s email as context</h3>

<p>Add the following to your <code class="prettyprint">ApplicationController</code> class:</p>
<pre class="highlight ruby"><code><span class="n">before_filter</span> <span class="ss">:set_scout_context</span>
</code></pre>

<p>Create the following method:</p>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">set_scout_context</span> 
    <span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">(</span><span class="ss">email: </span><span class="n">current_user</span><span class="p">.</span><span class="nf">email</span><span class="p">)</span> <span class="k">if</span> <span class="n">current_user</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">User</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>

<h3 id="example-adding-the-monthly-spend-as-context">Example: adding the monthly spend as context</h3>

<p>Add the following line to the <code class="prettyprint">ApplicationController#set_scout_context</code> method defined above:</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">monthly_spend: </span><span class="n">current_org</span><span class="p">.</span><span class="nf">monthly_spend</span><span class="p">)</span> <span class="k">if</span> <span class="n">current_org</span>
</code></pre>

<h2 id="environments">Environments</h2>

<p>It typically makes sense to treat each environment (production, staging, etc) as a separate application within Scout and ignore the development and test environments.</p>

<p>Here&rsquo;s an example <code class="prettyprint">scout_apm.yml</code> configuration to achieve this:</p>
<pre class="highlight ruby"><code><span class="ss">common: </span><span class="o">&amp;</span><span class="n">defaults</span>
  <span class="ss">name: name: </span><span class="o">&lt;</span><span class="sx">%= "YOUR_APP_NAME (#{Rails.env})" %&gt;
  key: YOUR_KEY
  log_level: debug
  monitor: true

production:
  &lt;&lt;: *defaults

development:
  &lt;&lt;: *defaults
  monitor: false

test:
  &lt;&lt;: *defaults
  monitor: false

staging:
  &lt;&lt;: *defaults
</span></code></pre>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
