<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>Help Docs ~ Scout APM</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/screen_overrides.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

    <link href='https://fonts.googleapis.com/css?family=Exo:400,400italic,700,700italic,800,800italic|Signika:400,700,300' rel='stylesheet' type='text/css'> 


    <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-3212349-13', 'auto');
      ga('send', 'pageview');
    </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <a href="/"><img id="logo" src="images/logo.png" /></a>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="scout-apm-help-docs">Scout APM Help Docs</h1>

<p>Welcome to the help site for <strong><a href="https://scoutapp.com">Scout Application Monitoring</a></strong>. Don&rsquo;t have an account? <a href="https://apm.scoutapp.com/users/sign_up">Get started with a free trial</a>.</p>

<p>Browse through the sidebar, search, or <a href="mailto:apm.support@scoutapp.com">ask a question</a>. We&rsquo;re here to help.</p>

<p><em>Looking for our server monitoring help? Goto <a href="http://help.scoutapp.com">help.scoutapp.com</a>.</em></p>

<h2 id="overview">Overview</h2>

<p>Scout Application Monitoring is a lightweight, production-grade application monitoring service built for modern development teams. Just embed our agent in your application: we handle the rest. </p>

<iframe width="560" height="315" src="https://www.youtube.com/embed/7wMyhc0FZII" frameborder="0" allowfullscreen></iframe>

<p>Here&rsquo;s an overview of the key functionality in our application monitoring service:</p>

<h3 id="the-agent">The Agent</h3>

<p>We currently monitor Ruby on Rails apps. Support for other languages and frameworks is under development. </p>

<p>Our agent is designed to run in production environments and has low overhead. Every minute, the agent transmits metrics to our service over SSL. </p>

<p>There&rsquo;s nothing to install on your servers: just include our Ruby Gem within your Rails app. You&rsquo;ll quickly see actionable metrics from the <a href="#instrumented-libraries">common libraries we instrument</a>.</p>

<h3 id="user-interface">User Interface</h3>

<p>A complete overview of the Scout UX is available in the <a href="#features">features</a> area of this help site.</p>

          <h1 id="configuration">Configuration</h1>

<h2 id="requirements">Requirements</h2>

<h3 id="monitoring">Monitoring</h3>

<p>Scout currently supports Ruby on Rails 2.2+ and Ruby 1.8.7+ and the following app servers:</p>

<ul>
<li>Phusion Passenger</li>
<li>Puma</li>
<li>Rainbows</li>
<li>Thin</li>
<li>Unicorn</li>
<li>WEBrick</li>
</ul>

<h3 id="stack-profiling-optional">Stack Profiling - Optional</h3>

<p>Stack Profiling requires Ruby 2.1+.</p>

<p>You must explicitly add the stackprof gem to your Gemfile:</p>
<pre class="highlight ruby"><code><span class="n">gem</span> <span class="s1">'stackprof'</span><span class="p">,</span> <span class="s1">'~&gt; 0.2.7'</span>
</code></pre>

<h3 id="git-integration-optional">Git Integration - Optional</h3>

<p>Viewing your application code within Scout requires that your source code is hosted at Github.com.</p>

<h2 id="installation">Installation</h2>

<p>Tailored instructions are provided within our user interface. General instructions:</p>

<table class="help install">
  <tbody>
        <tr>
      <td>
        <span class="step">1</span>
      </td>
      <td>
                <p>Your Gemfile:</p>

<pre>
gem 'scout_apm'
</pre>

                    <p><strong>Shell:</strong></p>

<pre>
bundle install
</pre>
      </td>
     </tr>
     <tr>
        <td><span class="step">2</span></td>
        <td><p>Download your customized config file, placing it at <code>config/scout_apm.yml</code>.</p></td>
     </tr>
          <tr>
        <td><span class="step">3</span></td>
        <td><p>Deploy.</p></td>
     </tr>
    </tbody>
 </table>

<h2 id="configuration-options">Configuration Options</h2>

<p>Scout APM can be configured via the <code class="prettyprint">config/scout_apm.yml</code> Yaml file and/or environment variables. A config file with your organization key is available for download as part of the install instructions.</p>

<h3 id="erb-evaluation">ERB evaluation</h3>

<p>ERB is evaluated when loading the config file. For example, you can set the app name based on the hostname:</p>
<pre class="highlight yaml"><code><span class="s">common</span><span class="pi">:</span> <span class="nl">&amp;defaults</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">&lt;%= "ProjectPlanner.io (#{Rails.env})" %&gt;</span>
</code></pre>

<h3 id="configuration-reference">Configuration Reference</h3>

<p>The following configuration settings are available:</p>

<table class="lookup">
    <thead>
      <tr>
        <th>
          Setting&nbsp;Name
        </th>
        <th>
          Description
        </th>
        <th>
          Default
        </th>
        <th>
          Required
        </th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <th>
          name
        </th>
        <td>
          Name of the application (ex: &lsquo;Photos App&rsquo;).
        </td>
        <td>
          <code>Rails.application.class.to_s.
             sub(/::Application$/, '')</code>
        </td>
        <td>
          Yes
        </td>
      </tr>
      <tr>
        <th>
          key
        </th>
        <td>
          The organization API key.
        </td>
        <td></td>
        <td>
          Yes
        </td>
      </tr>
      <tr>
        <th>
          monitor
        </th>
        <td>
          Whether monitoring should be enabled. 
        </td>
        <td>
          <code>false</code>
        </td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          log_level
        </th>
        <td>
          The logging level of the agent. 
        </td>
        <td>
          <code>INFO</code>
        </td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          log_file_path
        </th>
        <td>The path to the <code>scout_apm.log</code> log file directory. Use <code>stdout</code> to log to STDOUT.
        </td>
        <td>
          <code>Environment#root+log/</code>&nbsp;or <code>STDOUT</code> if running on Heroku.
        </td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          hostname
        </th>
        <td>
          The hostname the metrics should be aggregrated under. 
        </td>
        <td>
          <code>Socket.gethostname</code>
        </td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          proxy
        </th>
        <td>Specify the proxy URL (ex: <code>https://proxy</code>) if a proxy is required. 
        </td>
        <td></td>
        <td>
          No
        </td>
      </tr>
      <tr>
        <th>
          host
        </th>
        <td>
          The protocol + domain where the agent should report. 
        </td>
        <td>
          <code>https://apm.scoutapp.com</code>
        </td>
        <td>
          No
        </td>
      </tr>
    </tbody>
  </table>

<h3 id="environment-variables">Environment Variables</h3>

<p>You can also configure Scout APM via environment variables. <em>Environment variables override settings provided in</em> <code class="prettyprint">scout_apm.yml</code>.</p>

<p>Environment variables have the same names as those in the Yaml config file, but are prefixed with <code class="prettyprint">SCOUT_</code>. For example, to set the organization key via environment variables:</p>
<pre class="highlight ruby"><code><span class="n">export</span> <span class="no">SCOUT_KEY</span><span class="o">=</span><span class="no">YOURKEY</span>
</code></pre>

<h2 id="docker">Docker <img src="images/docker.png" style="float:right;width: 150px" /></h2>

<p>Scout runs within Docker containers without any special configuration. </p>

<p>It&rsquo;s common to configure Docker containers with environment variables. Scout can use <a href="#environment-variables">enviornment variables</a> instead of the <code class="prettyprint">scout_apm.yml</code> config file.</p>

<h2 id="heroku">Heroku <img src="images/heroku.png" style="float:right;width: 150px" /></h2>

<p>Scout runs on Heroku without any special configuration. When Scout detects that an app is being served via Heroku:</p>

<ul>
<li>Logging is set to <code class="prettyprint">STDOUT</code> vs. logging to a file. Log messages are prefixed with <code class="prettyprint">[Scout]</code> for easy filtering.</li>
<li>The dyno name (ex: <code class="prettyprint">web.1</code>) is reported vs. the dyno hostname. Dyno hostnames are dynamically generated and don&rsquo;t have any meaningful information.</li>
</ul>

<h3 id="configuration">Configuration</h3>

<p>Scout can be configured via environment variables. This means you can use <code class="prettyprint">heroku config:set</code> to configure the agent. For example, you can set the application name that appears in the Scout UI with:</p>
<pre class="highlight shell"><code>heroku config:set <span class="nv">SCOUT_NAME</span><span class="o">=</span><span class="s1">'My Heroku App'</span>
</code></pre>

<p>See the configuration section for more information on the available config settings and environment variable functionality.</p>

<h2 id="cloud-foundry">Cloud Foundry <img src="images/cf_logo.png" style="float:right;width: 150px" /></h2>

<p>Scout runs on Cloud Foundry without any special configuration. </p>

<p>We suggest a few configuration changes in the <code class="prettyprint">scout_apm.yml</code> file to best take advantage of Cloud Foundry:</p>

<ol>
<li>Set <code class="prettyprint">log_file_path: STDOUT</code> to send your the Scout APM log contents to the Loggregator. </li>
<li>Use the application name configured via Cloud Foundry to identify the app.</li>
<li>Override the hostname reported to Scout. Cloud Foundry hostnames are dynamically generated and don&rsquo;t have any meaningful information. We suggest using a combination of the application name and the instance index.</li>
</ol>

<p>A sample config for Cloud Foundry that implements the above suggestions:</p>
<pre class="highlight yaml"><code><span class="s">common</span><span class="pi">:</span> <span class="nl">&amp;defaults</span>
  <span class="s">key</span><span class="pi">:</span> <span class="s">YOUR_KEY</span>
  <span class="s">monitor</span><span class="pi">:</span> <span class="s">true</span>
  <span class="c1"># use the configured application name to identify the app.</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">&lt;%= ENV['VCAP_APPLICATION'] ? JSON.parse(ENV['VCAP_APPLICATION'])['application_name']</span> <span class="pi">:</span> <span class="s2">"</span><span class="s">YOUR</span><span class="nv"> </span><span class="s">APP</span><span class="nv"> </span><span class="s">NAME</span><span class="nv"> </span><span class="s">(#{Rails.env})"</span> <span class="err">%</span><span class="pi">&gt;</span>
  <span class="no"># make logs available to the Loggregator</span>
  <span class="no">log_file_path: STDOUT</span>
  <span class="no"># reports w/a more identifiable instance name using the application name and instance index. ex: rails-sample.0</span>
  <span class="no">hostname: &lt;%= ENV['VCAP_APPLICATION'] ? "#{JSON.parse(ENV['VCAP_APPLICATION'])['application_name']}.#{ENV['CF_INSTANCE_INDEX']}"  : Socket.gethostname %&gt;</span>

<span class="s">production</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>

<span class="s">development</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>
  <span class="s">monitor</span><span class="pi">:</span> <span class="s">false</span>

<span class="s">test</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>
  <span class="s">monitor</span><span class="pi">:</span> <span class="s">false</span>

<span class="s">staging</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>
</code></pre>

<h2 id="instrumented-libraries">Instrumented Libraries</h2>

<p>The following libraries are currently instrumented:</p>

<ul>
<li>ActiveRecord</li>
<li>ActionView</li>
<li>ActionController</li>
<li>Mongoid</li>
<li>Net::HTTP</li>
<li>Moped</li>
</ul>

<h2 id="adding-custom-context">Adding Custom Context</h2>

<p><a href="#context">Context</a> lets you see the forest from the trees. For example, you can add custom context to answer critical questions like:</p>

<ul>
<li>How many users are impacted by slow requests?</li>
<li>How many trial customers are impacted by slow requests?</li>
<li>How much of an impact are slow requests having on our highest paying customers?</li>
</ul>

<p>It&rsquo;s simple to add <a href="#context">custom context</a> to your app. There are two types of context:</p>

<h3 id="user-context">User Context</h3>

<p>For context used to identify users (ex: email, name):</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">({})</span>
</code></pre>

<p>Examples:</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">(</span><span class="ss">email: </span><span class="vi">@user</span><span class="p">.</span><span class="nf">email</span><span class="p">)</span>
<span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">(</span><span class="ss">email: </span><span class="vi">@user</span><span class="p">.</span><span class="nf">email</span><span class="p">,</span> <span class="ss">location: </span><span class="vi">@user</span><span class="p">.</span><span class="nf">location</span><span class="p">.</span><span class="nf">to_s</span><span class="p">)</span>
</code></pre>

<h3 id="general-context">General Context</h3>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">({})</span>
</code></pre>

<p>Examples:</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">account: </span><span class="vi">@account</span><span class="p">.</span><span class="nf">name</span><span class="p">)</span>
<span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">database_shard: </span><span class="vi">@db</span><span class="p">.</span><span class="nf">shard_id</span><span class="p">,</span> <span class="ss">monthly_spend: </span><span class="vi">@account</span><span class="p">.</span><span class="nf">monthly_spend</span><span class="p">)</span>
</code></pre>

<h3 id="default-context">Default Context</h3>

<p>Scout reports the Request URI and the user&rsquo;s remote IP Address by default.</p>

<h3 id="context-types">Context Types</h3>

<p>Context values can be any of the following types:</p>

<ul>
<li>Numeric</li>
<li>String</li>
<li>Boolean</li>
<li>Time</li>
<li>Date</li>
</ul>

<h3 id="context-field-name-restrictions">Context Field Name Restrictions</h3>

<p>Custom context names may contain alphanumeric characters, dashes, and underscores. Spaces are not allowed.</p>

<p>Attempts to add invalid context will be ignored.</p>

<h3 id="example-adding-the-current-user-39-s-email-as-context">Example: adding the current user&rsquo;s email as context</h3>

<p>Add the following to your <code class="prettyprint">ApplicationController</code> class:</p>
<pre class="highlight ruby"><code><span class="n">before_filter</span> <span class="ss">:set_scout_context</span>
</code></pre>

<p>Create the following method:</p>
<pre class="highlight ruby"><code><span class="k">def</span> <span class="nf">set_scout_context</span> 
    <span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add_user</span><span class="p">(</span><span class="ss">email: </span><span class="n">current_user</span><span class="p">.</span><span class="nf">email</span><span class="p">)</span> <span class="k">if</span> <span class="n">current_user</span><span class="p">.</span><span class="nf">is_a?</span><span class="p">(</span><span class="no">User</span><span class="p">)</span>
<span class="k">end</span>
</code></pre>

<h3 id="example-adding-the-monthly-spend-as-context">Example: adding the monthly spend as context</h3>

<p>Add the following line to the <code class="prettyprint">ApplicationController#set_scout_context</code> method defined above:</p>
<pre class="highlight ruby"><code><span class="no">ScoutApm</span><span class="o">::</span><span class="no">Context</span><span class="p">.</span><span class="nf">add</span><span class="p">(</span><span class="ss">monthly_spend: </span><span class="n">current_org</span><span class="p">.</span><span class="nf">monthly_spend</span><span class="p">)</span> <span class="k">if</span> <span class="n">current_org</span>
</code></pre>

<h2 id="environments">Environments</h2>

<p>It typically makes sense to treat each environment (production, staging, etc) as a separate application within Scout and ignore the development and test environments.</p>

<p>Here&rsquo;s an example <code class="prettyprint">scout_apm.yml</code> configuration to achieve this:</p>
<pre class="highlight yaml"><code><span class="s">common</span><span class="pi">:</span> <span class="nl">&amp;defaults</span>
  <span class="s">name</span><span class="pi">:</span> <span class="s">&lt;%= "YOUR_APP_NAME (#{Rails.env})" %&gt;</span>
  <span class="s">key</span><span class="pi">:</span> <span class="s">YOUR_KEY</span>
  <span class="s">log_level</span><span class="pi">:</span> <span class="s">debug</span>
  <span class="s">monitor</span><span class="pi">:</span> <span class="s">true</span>

<span class="s">production</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>

<span class="s">development</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>
  <span class="s">monitor</span><span class="pi">:</span> <span class="s">false</span>

<span class="s">test</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>
  <span class="s">monitor</span><span class="pi">:</span> <span class="s">false</span>

<span class="s">staging</span><span class="pi">:</span>
  <span class="s">&lt;&lt;</span><span class="pi">:</span> <span class="nv">*defaults</span>
</code></pre>

          <h1 id="troubleshooting">Troubleshooting</h1>

<h2 id="no-data">No Data</h2>

<p>Not seeing any data?</p>

<table class="help">
    <tbody><tr>
      <td>
        <span class="step">1</span>
      </td>
      <td>
        <p>Is there a <code>log/scout_apm.log</code> file?
        </p>
        <p>
          If not, the gem was never initialized by the application. <a href="#step6">Jump to the last step</a>.<br>If there is a file, examine the file for any error messages:</p>
        <p></p>
<pre>
tail -n1000 log/scout_apm.log | grep "Starting monitoring" -A20
</pre>
          See something noteworthy? Proceed to <a href="#step6">to the last step</a>.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="step">2</span>
      </td>
      <td>
        <p>
          Using Unicorn?
        </p>
        <p>Add the <code>preload_app true</code> directive to your Unicorn config file. <a href="http://unicorn.bogomips.org/Unicorn/Configurator.html#method-i-preload_app">Read more</a> in the Unicorn docs.
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="step">3</span>
      </td>
      <td>
        <p>Was the <code><strong>scout_apm</strong></code> gem deployed with your application?
        </p>
<pre>
bundle list scout_apm
</pre>
      </td>
    </tr>
    <tr>
      <td>
        <span class="step">4</span>
      </td>
      <td>
        <p>Did you download the config file, placing it in <code><strong>config/scout_apm.yml</strong></code>?
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="step">5</span>
      </td>
      <td>
        <p>
          Did you restart the app?
        </p>
      </td>
    </tr>
    <tr>
      <td>
        <span class="step">6</span>
      </td>
      <td>
        <a name="step6"></a>Are you sure the application has processed any requests?
<pre>
tail -n1000 log/production.log | grep "Processing"
</pre>
      </td>
    </tr>
    <tr>
      <td>
        <span class="step">7</span>
      </td>
      <td>
        <p>
          Oops! Looks like messed up. <a href="mailto:support@scoutapp.com">Send us an email</a> with the following:
        </p>
        <ul>
          <li>The last 1000 lines of your <code>log/scout_apm.log</code> file: <code>tail -n1000 log/scout_apm.log</code>.
          </li>
          <li>Your application&rsquo;s gems <code>bundle list</code>.
          </li>
          <li>
            Rails version
          </li>
          <li>
            Application Server (examples: Passenger, Thin, etc.)
          </li>
          <li>
            Web Server (examples: Apache, Nginx, etc.)
          </li>
        </ul>
        <p>
          We typically respond within a couple of hours during the business day.
        </p>
      </td>
    </tr>
  </tbody></table>

<h2 id="service-status">Service Status</h2>

<p>We&rsquo;re transparent about our uptime and service issues. If you appear to be experiencing issues with our service:</p>

<ul>
<li><a href="http://status.scoutapp.com">Check out status site</a>. You can subscribe to service incidents. </li>
<li><a href="mailto:support@scoutapp.com">Email us</a></li>
</ul>

<h2 id="contacting-support">Contacting Support</h2>

<p>Don&rsquo;t hesitate to contact us at <a href="mailto:support@scoutapp.com">apm.support@scoutapp.com</a> any issues. We typically respond in a couple of hours during the business day.</p>

          <h1 id="features">Features</h1>

<p>Scout is Application Monitoring built for modern development teams. It&rsquo;s built to provide the fastest path to a slow line-of-code. <a href="https://apm.scoutapp.com/users/sign_up">Signup for a free trial</a>.</p>

<h2 id="app-performance-overview">App Performance Overview</h2>

<p>The overview page provides an at-a-glance, auto-refreshing view of your app&rsquo;s performance and resource usage. You can compare metrics in the overview chart and see how your app&rsquo;s performance compares to different time periods.</p>

<p><img alt="overview" src="images/dash_annotated.png" /></p>

<h3 id="zooming-into-slow-requests">Zooming into Slow Requests</h3>

<p>See a large spike in response time? Click-and-drag (or pinch-and-expand on an iPad) on the overview chart. You&rsquo;ll see the number of slow requests over the selected period. Click the link to view details on those requests.</p>

<p><img alt="overview drag" src="images/dash_drag_annotated.png" /></p>

<h2 id="slow-stream">Slow Stream</h2>

<p>The Slow Stream gives direct access to slow web requests (&gt;= 2 seconds).</p>

<p><img alt="stream" src="images/stream_annotated.png" /></p>

<p>Requests are aggregrated by the endpoint name. Scout captures details on every slow request your app handles - it doesn&rsquo;t sample - to ensure you have the complete picture of what&rsquo;s slow.</p>

<p>Click on an endpoint name to view details on slow requests for the respective endpoint.</p>

<h2 id="slow-request-details">Slow Request Details</h2>

<p>Dig into bottlenecks - down to the line-of-code, author, commit date, and deploy time - with the slow request detail view. </p>

<p><img alt="stream show" src="images/stream_show_annotated.png" /></p>

<h3 id="aggregrate-trace">Aggregrate Trace</h3>

<p>When clicking on an endpoint from the Slow Stream, you&rsquo;ll see an <strong>aggregrate trace</strong> by default. This aggregrates slow request traces from multiple requests together so you can see common bottlenecks across requests.</p>

<h3 id="individual-slow-requests">Individual Slow Requests</h3>

<p>You can view details on individual slow requests vs. an aggregrate trace by selecting the request in the sidebar.</p>

<p><img alt="stream show request" src="images/stream_show_request.png" /></p>

<h3 id="call-breakdown">Call Breakdown</h3>

<p>Method calls are aggregrated together and listed from most expensive to least expensive. The time displayed is the total time across all calls (not the time per-call).</p>

<p><img alt="stream show breakdown" src="images/stream_show_call_breakdown.png" /></p>

<h3 id="sql-queries">SQL Queries</h3>

<p>Scout captures a santized version of SQL queries. Click the &ldquo;SQL&rdquo; button next to a call to view details. </p>

<p><img alt="stream show sql" src="images/stream_show_sql_annotated.png" /></p>

<h4 id="don-39-t-see-the-query-next-to-an-sql-call">Don&rsquo;t see the query next to an SQL call?</h4>

<p>For performance reasons, Scout doesn&rsquo;t attempt to sanitize large SQL queries. When this occurs, you won&rsquo;t see an &ldquo;SQL&rdquo; button to view the raw query next to an SQL method call.</p>

<h3 id="code-backtraces">Code Backtraces</h3>

<p>You&rsquo;ll see &ldquo;CODE&rdquo; buttons next to method calls that are &gt;= 500 ms. If you&rsquo;ve enabled the Github integration, you can see the line-of-code, associated SQL or HTTP endpoint (if applicable), author, commit date, and deploy time for the relevant slow code.</p>

<p><img alt="stream show git" src="images/stream_slow_git_annotated.png" /></p>

<p>If you don&rsquo;t enable the Github integration, you&rsquo;ll see a backtrace.</p>

<h3 id="rate-limiting-of-slow-requests">Rate Limiting of Slow Requests</h3>

<p>Scout records details on every slow request but limits the collection of call breakdown metrics to ten slow requests per-server to prevent sending too much data to Scout.</p>

<h2 id="stack-profiling">Stack Profiling</h2>

<p>Stack profiling is separate from the standard request breakdowns. It samples the stack at regular intervals to determine where time is being spent.</p>

<p>Stack Profiling requires Ruby 2.1+. You must explicitly add the stackprof gem to your Gemfile:</p>
<pre class="highlight ruby"><code><span class="n">gem</span> <span class="s1">'stackprof'</span><span class="p">,</span> <span class="s1">'~&gt; 0.2.7'</span>
</code></pre>

<h2 id="git-integration">Git Integration</h2>

<p>If your code is hosted at Github, you can see the <a href="#code-backtraces">relevant slow line-of-code within the Scout user interface</a> when viewing slow request details. Additionally, you&rsquo;ll also see the:</p>

<ul>
<li>author</li>
<li>commit time</li>
<li>deploy time</li>
</ul>

<p>Git integration must be configured on the settings page for each app. Scout integrates with Github via OAuth. Pick the repository name and branch name used for your application.</p>

<p><img alt="git settings" src="images/git_settings_annotated.png" /></p>

<h2 id="context">Context</h2>

<p>Context lets you see the forest from the trees. For example, you can add custom context to answer critical questions like:</p>

<ul>
<li>How many users are impacted by slow requests?</li>
<li>How many trial customers are impacted by slow requests?</li>
<li>How much of an impact are slow requests having on our highest paying customers?</li>
</ul>

<p>Adding custom context is easy - <a href="#adding-custom-context">learn how</a>.</p>

<p>When viewing slow request details from the Slow Stream, click the &ldquo;Context&rdquo; link:</p>

<p><img alt="context" src="images/stream_show_context_annotated.png" /></p>

<p>You&rsquo;ll see a histogram representation for each piece of context for the endpoint.</p>

<h2 id="endpoints-performance">Endpoints Performance</h2>

<h3 id="endpoints-overview">Endpoints Overview</h3>

<p>The endpoints area within Scout provides a sortable view of your app&rsquo;s overall performance aggregated by endpoint name. Click on an endpoint to view details.</p>

<p><img alt="endpoints overview" src="images/endpoints_annotated.png" /></p>

<h3 id="endpoint-details">Endpoint Details</h3>

<p>View aggregated metrics across requests for a specific endpoint by clicking on the endpoint name from overview area. You can also drill into slow requests for this endpoint from this page.</p>

<p><img alt="endpoint details" src="images/endpoints_show_annotated.png" /></p>

<h2 id="time-comparisons">Time Comparisons</h2>

<p>You can easily compare the performance of your application between different time periods via the time selection on the top right corner of the UI.</p>

<p><img alt="time compare" src="images/time_compare_annotated.png" /></p>

<h2 id="data-retention">Data Retention</h2>

<p>Scout stores 30 days of metrics and seven days of slow request details.</p>

          <h1 id="reference">Reference</h1>

<h2 id="how-we-collect-metrics">How we collect metrics</h2>

<p>Scout is engineered to monitor the performance of your mission-critical production applications by providing an easy-install, low-overhead monitoring agent with a hosted SaaS service that values your security. The basic flow:</p>

<ul>
<li>Embed our agent in your application. You don&rsquo;t access to the servers your app is deployed on.</li>
<li>The agent instruments key libraries (database access, controllers, views, etc) using low-overhead instrumentation. </li>
<li>Every minute, the agent connects over https (always) through a 256-bit secure, encrypted connection (the same encryption your bank uses) and sends metrics to our servers.</li>
<li>Over servers store the data.</li>
</ul>

<h2 id="performance-overhead">Performance Overhead</h2>

<p>Our agent is designed to run in production environments. We&rsquo;ve benchmarked the response time overhead at roughly 3%. Generally, overhead increases as the number of methods are instrumented.</p>

<h2 id="security">Security</h2>

<p>We take the security of your code metrics extremely seriously. Keeping your data secure is fundamental to our business. Scout is nearing a decade storing critical metrics with our server monitoring product and those same fundamentals are applied here:</p>

<ul>
<li>All data transmitted by our agent to our servers is sent via SSL.</li>
<li>Our UI is only served under SSL.</li>
<li>When additional data is collected for slow calls (ex: SQL queries), query parameters are sanitized before sending these to our servers.</li>
</ul>

<h3 id="git-integration">Git Integration</h3>

<p>Scout only needs read-only access to your repository, but unfortunately, Github doesn&rsquo;t currently allow this - they only offer read-write permissions through their OAuth API.</p>

<p>We have asked Github to offer read-only permissions, and they&rsquo;ve said that the feature coming soon. In the mean time, we&rsquo;re limited to the permissions structure Github offers. Our current Git security practices:</p>

<ul>
<li>we don&rsquo;t clone your repository&rsquo;s code; we only pull the commit history</li>
<li>the commit history is secured on our servers according to industry best practices</li>
<li>authentication subsystems within our application ensure your commit history is never exposed to anyone outside your account.</li>
</ul>

<p>All that said, we suggest the following:</p>

<ul>
<li><a href="https://github.com/contact">Contact Github</a> about allowing read-only access. This will ensure it stays top-of-mind.</li>
<li>This is optional and you are able to view backtrace information w/o the integration. It&rsquo;s likely possible to even write a UserScript to open the code locally in your editor or on Github.</li>
</ul>

<h2 id="billing">Billing</h2>

<h3 id="free-trial">Free Trial</h3>

<p>We offer a no-risk, free 14-day trial. Delete your monitored apps before the trial concludes and you don&rsquo;t pay.</p>

<h3 id="billing-date">Billing Date</h3>

<p>Your first bill is 30 days after your signup date.</p>

<h3 id="subscription-style">Subscription Style</h3>

<p>You can choose the subscription style that makes sense for your organization. We offer two subscription styles:</p>

<h4 id="per-server">Per-Server</h4>

<p><strong>This is the default approach</strong>. You are billed for the number of servers that are actively reporting on your billing date. </p>

<h4 id="per-request">Per-Request</h4>

<p>If you have a smaller application or have many smaller instances or Docker containers per-request billing may make more sense. Volume discounts are automatically applied as your application handles more throughput. </p>

<h3 id="changing-your-subsciption-style">Changing your subsciption style</h3>

<p>You can pick your subscription styles in the billing area within Scout. Your billing preference can not be retroactively applied.</p>

<h2 id="replacing-new-relic">Replacing New Relic</h2>

<p>Scout is an attractive option for modern dev teams (frequent deploys, using Git, deploying to many micro instances &amp; containers, using vendors for key infrastructure services like Amazon RDS, etc). We provide a laser-focus on getting to slow custom application code fast vs. wide breadth as debugging slow custom application code is typically the most time-intensive performance optimization work. </p>

<p>In many cases, Scout is able to replace New Relic as-is. However, there are cases where your app has specific needs we currently don&rsquo;t provide. Don&rsquo;t fret - here&rsquo;s some of the more common scenarios and our suggestions for building a monitoring stack you&rsquo;ll love:</p>

<ul>
<li><strong>Exception Monitoring</strong> - we provide metrics on the rate of exceptions but we don&rsquo;t currently provide details on exceptions. Our favorite tool for this is <a href="http://getsentry.com">Sentry</a>:

<ul>
<li>Affordable: starts @ $29/mo. </li>
<li>Realtime exceptions: you&rsquo;ll see new exceptions coming through as-they-happen (every second). </li>
<li>Great UI</li>
<li>Context tracking (easy to see how an exception is impacting which users). We implemented a similar API for our slow request tracking.</li>
</ul></li>
<li><strong>Alerting</strong> - while on our roadmap, we don&rsquo;t yet provide alerting within application monitoring. However, <a href="https://scoutapp.com/info/server_monitoring">Scout Server Monitoring</a> has robust alerting functionality. With the <a href="https://github.com/scoutapp/scout_statsd_rack">Scout StatsD Rack Gem</a> you can easily get alerted on jumps in error rates and response times.</li>
<li><strong>Background Job Monitoring</strong> - this is on our roadmap as well. <a href="https://scoutapp.com/info/server_monitoring">Scout Server Monitoring</a> can be used to monitor queue depths, failure rates, etc for all of the common Ruby background job systems. Many background job systems also provide a web ui (for example, the <a href="https://github.com/mperham/sidekiq/wiki/Monitoring#web-ui">Sidekiq Web UI</a>).</li>
<li><strong>Browser Monitoring (Real User Monitoring)</strong> - there are a number of dedicated tools for both Real User Monitoring (RUM) and synthetic monitoring. You can also continue to use New Relic for browser monitoring and use Scout for application monitoring.</li>
</ul>

<h3 id="our-monitoring-stack">Our Monitoring Stack</h3>

<p>Curious about what a company that lives-and-breathes monitoring (us!) uses to monitor our apps? <a href="http://blog.scoutapp.com/articles/2015/12/02/rails-monitoring-stack-2016">We shared our complete monitoring stack on our blog</a>.</p>

<h3 id="talk-to-us-about-your-monitoring-stack">Talk to us about your monitoring stack</h3>

<p>Don&rsquo;t hesitate to <a href="mailto:apm.support@scoutapp.com">email us</a> if you need to talk through your monitoring stack. Monitoring is something we know and love.</p>

      </div>
      <div class="dark-box">
      </div>
    </div>
  </body>
</html>
